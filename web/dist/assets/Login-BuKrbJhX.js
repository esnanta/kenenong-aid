import{r as x,j as e,u as K,f as q,g as W,h as Z,H as ee,C as re,a as se,b as te,e as ae,d as oe,L as D,B as ne,t as l,i as ie}from"./app-BLAu0s-k.js";import{u as ce,a as de,o as le,b as me,s as M}from"./schemas-BlBNX1Er.js";import{I as O}from"./input-DhAMWrKR.js";import{L as F}from"./label-7NtcvhHA.js";import{c as ue,P as fe,a as L,u as pe,b as H,C as he}from"./index-DfJ-yVqU.js";import{u as be}from"./index-CAGsf3C7.js";import{u as xe}from"./index-Dpf8Yrbs.js";import{A as ye}from"./AuthLayout-DNT1o66I.js";var _="Checkbox",[ke]=ue(_),[Ce,B]=ke(_);function ve(s){const{__scopeCheckbox:m,checked:o,children:i,defaultChecked:c,disabled:t,form:k,name:C,onCheckedChange:f,required:p,value:v="on",internal_do_not_use_render:a}=s,[h,g]=pe({prop:o,defaultProp:c??!1,onChange:f,caller:_}),[b,w]=x.useState(null),[N,n]=x.useState(null),d=x.useRef(!1),I=b?!!k||!!b.closest("form"):!0,S={checked:h,disabled:t,setChecked:g,control:b,setControl:w,name:C,form:k,value:v,hasConsumerStoppedPropagationRef:d,required:p,defaultChecked:j(c)?!1:c,isFormControl:I,bubbleInput:N,setBubbleInput:n};return e.jsx(Ce,{scope:m,...S,children:ge(a)?a(S):i})}var z="CheckboxTrigger",G=x.forwardRef(({__scopeCheckbox:s,onKeyDown:m,onClick:o,...i},c)=>{const{control:t,value:k,disabled:C,checked:f,required:p,setControl:v,setChecked:a,hasConsumerStoppedPropagationRef:h,isFormControl:g,bubbleInput:b}=B(z,s),w=K(c,v),N=x.useRef(f);return x.useEffect(()=>{const n=t==null?void 0:t.form;if(n){const d=()=>a(N.current);return n.addEventListener("reset",d),()=>n.removeEventListener("reset",d)}},[t,a]),e.jsx(L.button,{type:"button",role:"checkbox","aria-checked":j(f)?"mixed":f,"aria-required":p,"data-state":Y(f),"data-disabled":C?"":void 0,disabled:C,value:k,...i,ref:w,onKeyDown:H(m,n=>{n.key==="Enter"&&n.preventDefault()}),onClick:H(o,n=>{a(d=>j(d)?!0:!d),b&&g&&(h.current=n.isPropagationStopped(),h.current||n.stopPropagation())})})});G.displayName=z;var T=x.forwardRef((s,m)=>{const{__scopeCheckbox:o,name:i,checked:c,defaultChecked:t,required:k,disabled:C,value:f,onCheckedChange:p,form:v,...a}=s;return e.jsx(ve,{__scopeCheckbox:o,checked:c,defaultChecked:t,disabled:C,required:k,onCheckedChange:p,name:i,form:v,value:f,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(G,{...a,ref:m,__scopeCheckbox:o}),h&&e.jsx($,{__scopeCheckbox:o})]})})});T.displayName=_;var U="CheckboxIndicator",V=x.forwardRef((s,m)=>{const{__scopeCheckbox:o,forceMount:i,...c}=s,t=B(U,o);return e.jsx(fe,{present:i||j(t.checked)||t.checked===!0,children:e.jsx(L.span,{"data-state":Y(t.checked),"data-disabled":t.disabled?"":void 0,...c,ref:m,style:{pointerEvents:"none",...s.style}})})});V.displayName=U;var X="CheckboxBubbleInput",$=x.forwardRef(({__scopeCheckbox:s,...m},o)=>{const{control:i,hasConsumerStoppedPropagationRef:c,checked:t,defaultChecked:k,required:C,disabled:f,name:p,value:v,form:a,bubbleInput:h,setBubbleInput:g}=B(X,s),b=K(o,g),w=be(t),N=xe(i);x.useEffect(()=>{const d=h;if(!d)return;const I=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(I,"checked").set,r=!c.current;if(w!==t&&R){const y=new Event("click",{bubbles:r});d.indeterminate=j(t),R.call(d,j(t)?!1:t),d.dispatchEvent(y)}},[h,w,t,c]);const n=x.useRef(j(t)?!1:t);return e.jsx(L.input,{type:"checkbox","aria-hidden":!0,defaultChecked:k??n.current,required:C,disabled:f,name:p,value:v,form:a,...m,tabIndex:-1,ref:b,style:{...m.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});$.displayName=X;function ge(s){return typeof s=="function"}function j(s){return s==="indeterminate"}function Y(s){return j(s)?"indeterminate":s?"checked":"unchecked"}const J=x.forwardRef(({className:s,...m},o)=>e.jsx(T,{ref:o,className:q("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...m,children:e.jsx(V,{className:q("grid place-content-center text-current"),children:e.jsx(he,{className:"h-4 w-4"})})}));J.displayName=T.displayName;const we=le({email:M().email("Invalid email address").min(1,"Email is required"),password:M().min(1,"Password is required"),rememberMe:me().default(!1)});function _e({model:s,errors:m}){var h,g;const{props:o}=W(),i=Z({email:(s==null?void 0:s.email)||"",password:"",rememberMe:!1}),{register:c,handleSubmit:t,watch:k,setValue:C,formState:{errors:f,isSubmitting:p}}=ce({resolver:de(we),defaultValues:{email:(s==null?void 0:s.email)||"",password:"",rememberMe:!1}}),v=b=>{var S,R;const w=(S=document.querySelector('meta[name="csrf-token"]'))==null?void 0:S.getAttribute("content"),N=(R=document.querySelector('meta[name="csrf-param"]'))==null?void 0:R.getAttribute("content"),n=w||o.csrfToken,d=N||o.csrfParam;if(!n||!d){l.error("CSRF token missing. Please refresh the page.");return}const I={...b,[d]:n};ie.post("/auth/login",I,{preserveScroll:!0,onSuccess:r=>{var y,E;if((r==null?void 0:r.component)==="Dashboard/Index"||(y=r==null?void 0:r.url)!=null&&y.includes("/dashboard")){l.success("Login successfully");return}if((E=r==null?void 0:r.props)!=null&&E.errors&&Object.keys(r.props.errors).length>0){const u=r.props.errors;u.email&&(Array.isArray(u.email)?u.email.forEach(P=>l.error(P)):typeof u.email=="string"&&l.error(u.email)),u.password&&(Array.isArray(u.password)?u.password.forEach(P=>l.error(P)):typeof u.password=="string"&&l.error(u.password)),Object.entries(u).forEach(([P,A])=>{P!=="email"&&P!=="password"&&(Array.isArray(A)?A.forEach(Q=>l.error(Q)):typeof A=="string"&&l.error(A))})}},onError:r=>{console.error("Login Error:",r),r&&typeof r=="object"?(r.email&&(Array.isArray(r.email)?r.email.forEach(y=>l.error(y)):typeof r.email=="string"&&l.error(r.email)),r.password&&(Array.isArray(r.password)?r.password.forEach(y=>l.error(y)):typeof r.password=="string"&&l.error(r.password)),Object.entries(r).forEach(([y,E])=>{y!=="email"&&y!=="password"&&(Array.isArray(E)?E.forEach(u=>l.error(u)):typeof E=="string"&&l.error(E))})):l.error("Login failed. Please check your credentials.")}})},a={...f,...m};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Login | Yii2 - Modern Starter Kit"}),e.jsx(ye,{children:e.jsxs(re,{className:"border-0 shadow-none px-6",children:[e.jsxs(se,{className:"space-y-1 px-0",children:[e.jsx(te,{className:"text-2xl font-semibold tracking-tight",children:"Sign in"}),e.jsx(ae,{className:"text-base",children:"Enter your credentials to access your account"})]}),e.jsxs(oe,{className:"px-0",children:[e.jsxs("form",{onSubmit:t(v),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),e.jsx(O,{id:"email",type:"email",...c("email"),className:a.email?"border-destructive":"",disabled:p||i.processing,autoFocus:!0,placeholder:"Enter your email"}),a.email&&e.jsx("p",{className:"text-sm text-destructive font-medium",children:typeof a.email=="string"?a.email:((h=a.email)==null?void 0:h.message)||"Invalid email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(F,{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),e.jsx(D,{href:"/auth/forgot-password",className:"text-sm text-primary hover:underline font-medium",children:"Forgot password?"})]}),e.jsx(O,{id:"password",type:"password",...c("password"),className:a.password?"border-destructive":"",disabled:p||i.processing,placeholder:"Enter your password"}),a.password&&e.jsx("p",{className:"text-sm text-destructive font-medium",children:typeof a.password=="string"?a.password:((g=a.password)==null?void 0:g.message)||"Invalid password"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{id:"rememberMe",checked:k("rememberMe"),onCheckedChange:b=>{C("rememberMe",b),i.setData("rememberMe",b)}}),e.jsx(F,{htmlFor:"rememberMe",className:"text-sm font-normal cursor-pointer leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Remember me"})]}),e.jsx(ne,{type:"submit",variant:"default",className:"w-full",disabled:p||i.processing,children:p||i.processing?"Signing in...":"Sign in"})]}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Don't have an account? "}),e.jsx(D,{href:"/auth/register",className:"text-primary hover:underline font-medium",children:"Sign up"})]})]})]})})]})}export{_e as default};
