import{g as le,r as h,j as e,H as ce,L as k,B as c,C as ie,a as oe,b as he,e as ue,d as xe,i as y,t as Y}from"./app-BLAu0s-k.js";import{D as me,a as je,b as pe,d as ge,e as ve,f as ye,g as b,S as be}from"./DashboardLayout-lqqN-nb-.js";import{P as De,C as _e,F as G,E as Se,T as Ne,A as fe,a as Ce,b as we,c as ke,d as Te,e as Ae,f as Fe,g as Ie,h as Be,i as Me,j as Pe}from"./alert-dialog-ICCQbimj.js";import{B as J}from"./badge-NTSI7XBk.js";import{I as T}from"./input-DhAMWrKR.js";import{L as S}from"./label-7NtcvhHA.js";import{S as Q,a as W,b as Z,c as ee,d as f}from"./select-DUzayBVp.js";import{T as Ee,a as Le,b as A,c as F,d as ze,e as o}from"./table-DAQHUFWq.js";import{X as He}from"./Logo-BJkCVtS2.js";import{S as Ve}from"./square-pen-BWbyF03q.js";import"./index-DfJ-yVqU.js";import"./index-Dpf8Yrbs.js";import"./index-CAGsf3C7.js";function N({column:u,currentSortBy:r,currentSortOrder:a,onSort:i,children:C}){const D=r===u?a==="asc"?e.jsx(Be,{className:"ml-2 h-4 w-4"}):e.jsx(Me,{className:"ml-2 h-4 w-4"}):e.jsx(Pe,{className:"ml-2 h-4 w-4 opacity-50"});return e.jsx(F,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>i(u),children:e.jsxs("div",{className:"flex items-center",children:[C,D]})})}function es({disasters:u,pagination:r,filters:a,sort:i,disasterTypes:C,disasterStatuses:I}){var O,q;const{props:D}=le(),[x,B]=h.useState((a==null?void 0:a.search)||""),[m,M]=h.useState(((O=a==null?void 0:a.disaster_type)==null?void 0:O.toString())||""),[j,P]=h.useState(((q=a==null?void 0:a.disaster_status)==null?void 0:q.toString())||""),[p,E]=h.useState((a==null?void 0:a.date_from)||""),[g,L]=h.useState((a==null?void 0:a.date_to)||""),[z,w]=h.useState(null),[t,v]=h.useState({id:!0,type:!0,status:!0,startDate:!0,endDate:!0,description:!0,actions:!0}),d=(i==null?void 0:i.sort_by)||"created_at",n=(i==null?void 0:i.sort_order)||"desc",_=s=>{const l=d===s&&n==="asc"?"desc":"asc";y.get("/disasters",{...a,search:x,disaster_type:m||void 0,disaster_status:j||void 0,date_from:p||void 0,date_to:g||void 0,sort_by:s,sort_order:l,page:1},{preserveState:!0})},H=()=>{y.get("/disasters",{search:x||void 0,disaster_type:m||void 0,disaster_status:j||void 0,date_from:p||void 0,date_to:g||void 0,sort_by:d,sort_order:n,page:1},{preserveState:!0})},se=()=>{B(""),M(""),P(""),E(""),L(""),y.get("/disasters",{sort_by:d,sort_order:n,page:1},{preserveState:!0})},te=s=>{var K,X;const l=(K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content"),R=(X=document.querySelector('meta[name="csrf-param"]'))==null?void 0:X.getAttribute("content"),U=l||D.csrfToken,$=R||D.csrfParam;if(!U||!$){Y.error("CSRF token missing. Please refresh the page.");return}const ne={[$]:U};y.post(`/disasters/${s}/delete`,ne,{onSuccess:()=>{w(null),Y.success("Disaster deleted successfully")}})},V=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ae=s=>{switch(typeof s=="string"?Number.parseInt(s):s){case 1:return"destructive";case 2:return"outline";case 3:return"secondary";default:return"outline"}},re=s=>{const l=typeof s=="string"?Number.parseInt(s):s;return{1:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",2:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",3:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",4:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200",5:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",6:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",99:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"}[l]||"bg-gray-100 text-gray-800"},de=x||m||j||p||g;return e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:"Disasters | Yii2 - Modern Starter Kit"}),e.jsxs(me,{user:D.user,children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Disasters"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage disaster records and their details"})]}),e.jsx(k,{href:"/disasters/create",children:e.jsxs(c,{children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),"Add Disaster"]})})]}),e.jsxs(ie,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{children:"Disasters List"}),e.jsx(ue,{children:"A list of all disasters in the system"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(je,{children:[e.jsx(pe,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Columns"]})}),e.jsxs(ge,{align:"end",className:"w-48",children:[e.jsx(ve,{children:"Toggle Columns"}),e.jsx(ye,{}),e.jsx(b,{checked:t.id,onCheckedChange:s=>v({...t,id:s}),children:"ID"}),e.jsx(b,{checked:t.type,onCheckedChange:s=>v({...t,type:s}),children:"Type"}),e.jsx(b,{checked:t.status,onCheckedChange:s=>v({...t,status:s}),children:"Status"}),e.jsx(b,{checked:t.startDate,onCheckedChange:s=>v({...t,startDate:s}),children:"Start Date"}),e.jsx(b,{checked:t.endDate,onCheckedChange:s=>v({...t,endDate:s}),children:"End Date"}),e.jsx(b,{checked:t.description,onCheckedChange:s=>v({...t,description:s}),children:"Description"})]})]})})]})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("h3",{className:"font-semibold",children:"Filters"})]}),de&&e.jsxs(c,{variant:"ghost",size:"sm",onClick:se,children:[e.jsx(He,{className:"mr-2 h-4 w-4"}),"Clear All"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(T,{id:"search",type:"search",placeholder:"Description...",value:x,onChange:s=>B(s.target.value),className:"pl-9",onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),H())}})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"disaster-type",children:"Disaster Type"}),e.jsxs(Q,{value:m||"all",onValueChange:s=>M(s==="all"?"":s),children:[e.jsx(W,{id:"disaster-type",children:e.jsx(Z,{placeholder:"All"})}),e.jsxs(ee,{children:[e.jsx(f,{value:"all",children:"All Types"}),Object.entries(C||{}).map(([s,l])=>e.jsx(f,{value:s,children:l},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"disaster-status",children:"Status"}),e.jsxs(Q,{value:j||"all",onValueChange:s=>P(s==="all"?"":s),children:[e.jsx(W,{id:"disaster-status",children:e.jsx(Z,{placeholder:"All"})}),e.jsxs(ee,{children:[e.jsx(f,{value:"all",children:"All Statuses"}),Object.entries(I||{}).map(([s,l])=>e.jsx(f,{value:s,children:l},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"date-from",children:"Date From"}),e.jsx(T,{id:"date-from",type:"date",value:p,onChange:s=>E(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"date-to",children:"Date To"}),e.jsx(T,{id:"date-to",type:"date",value:g,onChange:s=>L(s.target.value)})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(c,{onClick:H,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Apply Filters"]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ee,{children:[e.jsx(Le,{children:e.jsxs(A,{children:[t.id&&e.jsx(N,{column:"id",currentSortBy:d,currentSortOrder:n,onSort:_,children:"ID"}),t.type&&e.jsx(N,{column:"disaster_type",currentSortBy:d,currentSortOrder:n,onSort:_,children:"Type"}),t.status&&e.jsx(N,{column:"disaster_status",currentSortBy:d,currentSortOrder:n,onSort:_,children:"Status"}),t.startDate&&e.jsx(N,{column:"start_date",currentSortBy:d,currentSortOrder:n,onSort:_,children:"Start Date"}),t.endDate&&e.jsx(N,{column:"end_date",currentSortBy:d,currentSortOrder:n,onSort:_,children:"End Date"}),t.description&&e.jsx(F,{children:"Description"}),t.actions&&e.jsx(F,{className:"text-right",children:"Actions"})]})}),e.jsx(ze,{children:u&&u.length>0?u.map(s=>e.jsxs(A,{children:[t.id&&e.jsx(o,{className:"font-medium",children:s.id}),t.type&&e.jsx(o,{children:e.jsx(J,{variant:"outline",className:re(s.disaster_type),children:s.disaster_type_label})}),t.status&&e.jsx(o,{children:e.jsx(J,{variant:ae(s.disaster_status),children:s.disaster_status_label})}),t.startDate&&e.jsx(o,{children:V(s.start_date)}),t.endDate&&e.jsx(o,{children:V(s.end_date)}),t.description&&e.jsx(o,{children:e.jsx("div",{className:"max-w-md truncate",children:s.description})}),t.actions&&e.jsx(o,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(k,{href:`/disasters/${s.id}`,children:e.jsx(c,{variant:"ghost",size:"sm",title:"View",children:e.jsx(Se,{className:"h-4 w-4"})})}),e.jsx(k,{href:`/disasters/${s.id}/edit`,children:e.jsx(c,{variant:"ghost",size:"sm",title:"Edit",children:e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>w(s.id),title:"Delete",children:e.jsx(Ne,{className:"h-4 w-4 text-destructive"})})]})})]},s.id)):e.jsx(A,{children:e.jsx(o,{colSpan:Object.values(t).filter(Boolean).length,className:"text-center text-muted-foreground py-8",children:"No disasters found"})})})]})}),r&&r.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing"," ",(r.current_page-1)*r.per_page+1," ","to"," ",Math.min(r.current_page*r.per_page,r.total)," ","of"," ",r.total," ","disasters"]}),e.jsxs("div",{className:"flex gap-2",children:[r.current_page>1&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>y.get("/disasters",{search:x||void 0,disaster_type:m||void 0,disaster_status:j||void 0,date_from:p||void 0,date_to:g||void 0,sort_by:d,sort_order:n,page:r.current_page-1},{preserveState:!0}),children:"Previous"}),r.current_page<r.last_page&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>y.get("/disasters",{search:x||void 0,disaster_type:m||void 0,disaster_status:j||void 0,date_from:p||void 0,date_to:g||void 0,sort_by:d,sort_order:n,page:r.current_page+1},{preserveState:!0}),children:"Next"})]})]})]})]})]}),e.jsx(fe,{open:z!==null,onOpenChange:()=>w(null),children:e.jsxs(Ce,{children:[e.jsxs(we,{children:[e.jsx(ke,{children:"Are you sure?"}),e.jsx(Te,{children:"This action will delete the disaster record. This action cannot be undone."})]}),e.jsxs(Ae,{children:[e.jsx(Fe,{children:"Cancel"}),e.jsx(Ie,{onClick:()=>te(z),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})]})}export{es as default};
